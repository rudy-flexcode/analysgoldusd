<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Suivi des ETF et Analyse RSI/SMA</title>
    <style>
        /* ... ton style ici ... */
    </style>
</head>
<body>
    <header>
        <h1>ETF Tracker Pro</h1>
        <div class="subtitle">Suivez et analysez les ETF en temps réel</div>
    </header>

    <div class="container">
        <!-- Carte 1 -->
        <div class="card">
            <h2>Suivi des ETF Gold et USD</h2>
            <p>Prix de l'ETF Gold : $<span id="gold_price"></span></p>
            <p>Prix de l'ETF USD : $<span id="usd_price"></span></p>
            <p><strong>Signal :</strong> <span id="signal"></span></p>
        </div>
        
        <!-- Carte 2 -->
        <div class="card">
            <h2>Analyse RSI</h2>
            <p>Valeur RSI : <span id="rsi"></span></p>
            <p><strong>Signal RSI :</strong> <span id="rsi_signal"></span></p>
        </div>
        
        <!-- Carte 3 -->
        <div class="card">
            <h2>Moyenne Mobile (SMA)</h2>
            <p>Valeur SMA : <span id="sma"></span></p>
            <p><strong>Signal SMA :</strong> <span id="sma_signal"></span></p>
        </div>
    </div>
    
    <button class="btn" onclick="refreshData()">Rafraîchir les données</button>
    <div id="loading"></div>
    
    <footer>
        <div class="legal">
            <!-- Mentions légales -->
        </div>
    </footer>

    <script>
        async function refreshData() {
            document.getElementById('loading').innerText = "Chargement des données...";
            try {
                const response = await fetch('/refresh');
                const text = await response.text();
                
                if (!response.ok) {
                    throw new Error('Erreur réseau');
                }

                let data;
                try {
                    data = JSON.parse(text);
                } catch (jsonError) {
                    console.error('Erreur lors de l\'analyse JSON:', jsonError);
                    throw new Error('Réponse invalide du serveur');
                }

                document.getElementById('gold_price').innerText = data.gold_price?.toFixed(2) || "N/A";
                document.getElementById('usd_price').innerText = data.usd_price?.toFixed(2) || "N/A";
                document.getElementById('signal').innerText = data.signal || "N/A";
                document.getElementById('rsi').innerText = data.rsi?.toFixed(2) || "N/A";
                document.getElementById('rsi_signal').innerText = data.rsi_signal || "N/A";
                document.getElementById('sma').innerText = data.sma?.toFixed(2) || "N/A";
                document.getElementById('sma_signal').innerText = data.sma_signal || "N/A";
            } catch (error) {
                console.error('Erreur:', error);
                document.getElementById('loading').innerText = "Erreur lors du chargement des données.";
            } finally {
                setTimeout(() => {
                    document.getElementById('loading').innerText = "";
                }, 2000);
            }
        }

        // Auto-refresh au chargement
        document.addEventListener('DOMContentLoaded', () => {
            refreshData();
            setInterval(refreshData, 300000);  // Rafraîchit toutes les 5 minutes
        });
    </script>
</body>
</html>
